<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>imgedit</title>
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="wasm.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="wasm_exec.js"></script>
    <script src="drop-zone.js"></script>
    <script src="wasm.js"></script>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>image edit tools</h1>
        <p>Image edit tools created from <a href="https://github.com/icemint0828/imgedit">imgedit package</a> with <a
                href="https://github.com/icemint0828/imgedit-wasm">wasm</a>.</p>
    </div>
    <div class="row">
        <div class="col-lg-12">
            <div>
                <ul class="nav tab-group"><!--nav-tabs nav-justified-->
                    <li class="active"><a href="#resize" data-toggle="tab">resize</a></li>
                    <li><a href="#grayscale" data-toggle="tab">grayscale</a></li>
                    <li><a href="#reverse" data-toggle="tab">reverse</a></li>
                </ul>
                <div class="content">
                    <div class="preview">
                        <h2>upload image</h2>
                        <div id="preview"></div>
                        <div id="error-message" style="color: crimson"></div>
                    </div>
                    <div class="operation">
                        <div class="drop">
                            <h2>upload area</h2>
                            <p>Drag and drop a file or</p>
                            <input class="button" type="file" name="file" id="file-input"
                                   accept=".png, .jpg, .jpeg, .gif" disabled>
                        </div>
                        <div class="tab-content">
                            <div class="tab-pane active" id="resize">
                                <h2> resize </h2>
                                <div>
                                    <label>width:&nbsp;<input type="number" max="5000" min="0" step="1"
                                                              id="width"></label>
                                    &nbsp;&nbsp;
                                    <label>height:&nbsp;<input type="number" max="5000" min="0" step="1"
                                                               id="height"></label>
                                </div>
                                <div></div>
                                <button class="button" onClick="resize();" disabled>execute</button>
                            </div>
                            <div class="tab-pane" id="grayscale">
                                <div id="drop-zone">
                                    <h2> grayscale </h2>
                                    <button class="button" onClick="grayscale();" disabled>
                                        execute
                                    </button>
                                </div>
                            </div>
                            <div class="tab-pane" id="reverse">
                                <h2> reverse </h2>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    ↓below button is only for test<br>
    <button class="button" id="confirm-button" onClick="confirm();">
        confirm
    </button>
    <button class="button" onClick="youTubeCheckDialog();">
        youTubeCheckDialog
    </button>
    <button class="button" onClick="youTubeCheckDialogReplace();">
        youTubeCheckDialogReplace
    </button>
</div>
<script>
    let preview = document.getElementById('preview')
    let errorMessage = document.getElementById("error-message")

    function previewBlob(blob) {
        /* FileReaderで読み込み、プレビュー画像を表示。 */
        let fr = new FileReader()
        fr.readAsDataURL(new File([blob], "name", {lastModified: 0}))
        fr.onload = function () {
            let img = document.createElement('img')
            img.setAttribute('src', fr.result)
            img.setAttribute('class', 'image')
            preview.innerHTML = ''
            preview.appendChild(img)
            errorMessage.innerHTML = 'edit success'
        };
    }

    function youTubeCheckDialog() {
        var confirmButton = document.getElementById('confirm-button')

        if (confirmButton === null) {
            return false;
        }

        clickYes(confirmButton);
        return true;
    }

    function youTubeCheckDialogReplace() {
        var confirmButton = document.getElementById('confirm-button')

        if (confirmButton === null) {
            return false;
        }

        clickYesReplace(confirmButton);
        return true;
    }

    function clickYes(button) {
        button.click();
        console.log(`clickYes`)
    }

    function clickYesReplace(button) {
        var currentButton = button
        currentButton.click();
        console.log(`clickYesReplace`)
    }

    function confirm() {
        console.log(`confirm`)
    }

</script>
</body>
</html>